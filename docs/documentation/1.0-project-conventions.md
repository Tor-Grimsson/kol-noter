# Project Conventions

This document outlines the coding conventions, architectural patterns, and organizational rules for the KOL Noter project.

---

## 1. Folder Structure

### Component Organization

The project uses a modified **Atomic Design** approach for UI components:

```
src/components/
├── ui-elements/           # Base UI components (atoms, molecules)
│   ├── atoms/            # Primitive components (Button, Input, Badge, etc.)
│   └── molecules/        # Compound components (MediaItem, ContactCard, etc.)
├── metadata/             # Metadata/detail view components
│   ├── MetadataNote.tsx      # Note detail view
│   ├── MetadataProject.tsx   # Project/System metadata panel
│   ├── MetadataDetailPanel.tsx # Unified detail panel
│   ├── sections/             # Reusable metadata sections
│   │   ├── MetadataSection.tsx
│   │   ├── MetricsSection.tsx
│   │   ├── MediaSection.tsx
│   │   ├── ConnectionsSection.tsx
│   │   └── DeleteSection.tsx
│   ├── constants.ts      # Shared constants for metadata views
│   └── index.ts          # Barrel export
├── overviews/           # Overview page components
│   ├── RootOverview.tsx
│   ├── SystemOverview.tsx
│   ├── ProjectOverview.tsx
│   └── TagsEditor.tsx
└── ...                  # Other feature components
```

### Naming Convention for Metadata Views

- **Pattern**: `Metadata{Type}.tsx`
- **Examples**:
  - `MetadataNote.tsx` - Note detail/metadata view
  - `MetadataProject.tsx` - Project/System metadata panel
  - `MetadataDetailPanel.tsx` - Unified detail panel for any item type

### Atomic Design Guidelines

| Level | Folder | Examples | Description |
|-------|--------|----------|-------------|
| Atom | `ui-elements/atoms/` | Button, Input, Badge | Primitive, single-purpose components |
| Molecule | `ui-elements/molecules/` | MediaItem, ContactCard | Compound components built from atoms |
| Organism | Feature folders | Metadata views, Overviews | Complex, feature-specific components |

---

## 2. Import Patterns

### Preferred: Barrel Exports

Use barrel exports (`index.ts`) for organized imports:

```typescript
// Good - use barrel export
import { MetadataSection, MetricsSection } from '@/components/metadata/sections';

// Good - direct import for single component
import { MetadataNote } from '@/components/metadata/MetadataNote';

// Avoid - deep imports when barrel exists
import { MetadataSection } from '@/components/metadata/sections/MetadataSection';
```

### Absolute Paths

Use the `@/` alias for absolute imports from `src/`:

```typescript
import { useNotesStore } from '@/store/NotesContext';
import { Button } from '@/components/ui/button';
```

---

## 3. Component Patterns

### Props Interface Naming

```typescript
// Component file: MetadataSection.tsx
interface MetadataSectionProps {
  name: string;
  description?: string;
  // ... other props
}

export function MetadataSection({ ... }: MetadataSectionProps) {
  // ...
}
```

### Default Exports

Default exports are preferred for page components:

```typescript
// Page components
export default function Index() {
  // ...
}
```

### Named Exports

Named exports are preferred for reusable components:

```typescript
// Reusable components
export function MetadataSection({ ... }: MetadataSectionProps) {
  // ...
}

export const METADATA_GRID_CLASS = "grid grid-cols-2 gap-4";
```

---

## 4. Style Guidelines

### Tailwind CSS

- Use utility classes for styling
- Prefix custom colors with semantic names when possible
- Maintain consistency with the design system

### CSS-in-JS (when needed)

For dynamic styles, use the `cn()` utility:

```typescript
import { cn } from "@/lib/utils";

<div className={cn(
  "base-class",
  condition && "conditional-class"
)} />
```

---

## 5. State Management

### Local State

Use React hooks for component-local state:

```typescript
const [isOpen, setIsOpen] = useState(false);
const [searchQuery, setSearchQuery] = useState("");
```

### Global State

Use the Zustand store (`notesStore.tsx`) for:

- Application data (notes, systems, projects)
- Cross-component state
- Persistence-triggering actions

### LocalStorage Persistence

Use the `useLocalStorage` hook for UI preferences:

```typescript
import { useLocalStorage } from "@/hooks/useLocalStorage";

const [sidebarCollapsed, setSidebarCollapsed] = useLocalStorage(
  "sidebar-collapsed",
  false
);
```

---

## 6. File Naming Rules

| Content | File Name | Example |
|---------|-----------|---------|
| Single component | PascalCase + Component type | `MetadataNote.tsx` |
| Multiple exports | Descriptive plural | `sections/index.ts` |
| Hooks | camelCase + "use" prefix | `usePersistence.ts` |
| Utilities | camelCase | `tauri-bridge.ts` |
| Constants | SCREAMING_SNAKE_CASE (for values) | `constants.ts` |

---

## 7. TypeScript Guidelines

### Type vs Interface

- Use `interface` for object types that may be extended
- Use `type` for unions, intersections, or primitive aliases

```typescript
// Interface - extensible
interface ItemMetadata {
  name: string;
  description?: string;
}

// Type - specific combinations
type ItemType = "note" | "project" | "system";
type HealthStatus = "good" | "warning" | "critical";
```

### Export Types

Always export types that are used externally:

```typescript
// In metadata/sections/MetadataSection.tsx
export interface MetadataSectionProps {
  name: string;
  // ...
}
```

---

## 8. Error Handling

### Try/Catch Pattern

Wrap async operations in try/catch:

```typescript
async function saveNote(note: Note) {
  try {
    await persistence.saveNote(note);
  } catch (error) {
    console.error("Failed to save note:", error);
    // Handle error (show toast, etc.)
  }
}
```

### User Feedback

Use dialogs for user-facing error messages:

```typescript
import { showMessage } from "@/lib/tauri-bridge";

await showMessage("Error", "Failed to save note", "error");
```

---

## 9. Testing Patterns

(To be documented)

---

## 10. Git Commit Messages

(To be documented - see separate conventions if available)

---

## Summary

- **Folder structure**: Modified Atomic Design with `ui-elements/`, `metadata/`, and feature folders
- **Naming**: `Metadata{Type}.tsx` for metadata views
- **Imports**: Use barrel exports via `@/` alias
- **State**: Local hooks + Zustand store
- **Types**: Interface for objects, type for unions
